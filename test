import smtplib
from email.mime.text import MIMEText
from email.mime.multipart import MIMEMultipart
from email.mime.application import MIMEApplication

# Email configuration
sender = "sender@example.com"
recipient = "recipient@example.com"
subject = "Test Email"
body = "This is a test email sent using Python and the smtplib module."

# Exchange server configuration
server = "exchange.example.com"
username = "your_username"
password = "your_password"

# Create message
message = MIMEMultipart()
message["From"] = sender
message["To"] = recipient
message["Subject"] = subject
message.attach(MIMEText(body, "plain"))

# Add attachment
with open("attachment.txt", "rb") as f:
    attachment = MIMEApplication(f.read(), _subtype="txt")
    attachment.add_header("Content-Disposition", "attachment", filename="attachment.txt")
    message.attach(attachment)

# Send email
try:
    smtp_obj = smtplib.SMTP(server)
    smtp_obj.starttls()
    smtp_obj.login(username, password)
    smtp_obj.sendmail(sender, recipient, message.as_string())
    smtp_obj.quit()
    print("Email sent successfully!")
except smtplib.SMTPException as e:
    print("Error: {}".format(str(e)))
